<template name="game">
  <h2>round <b>{{ round }}</b></h2>

  <div class="hidden-role-container">
    <div class="toggle-role">show/hide</div>
    <h2 id="hidden-role" class=" hidden-role show">you're <b>{{ role }}</b>!</h2>
  </div>

  {{> flashMessages }}
  {{# if equals room.fascist 5 }}
    <small>veto power unlocked!</small>
  {{/ if }}
  <p>
    <small>policy count</small>{{ policycount }}
    <br />
    <table class="policy-count">
      <tr>
        <td>
          <span style="font-size:2.0em;">{{ room.liberal }}</span>/5
        </td>
        <td>
          <span style="font-size:2.0em;">{{ room.fascist }}</span>/6
        </td>
      </tr>
      <tr>
        <td>
          <small>liberal</small>
        </td>
        <td>
          <small>fascist</small>
        </td>
      </tr>
    </table>
    <div class="game-board">
      <div class="liberal-board-container">
        <div class="liberal-board">
          <div class="tile"></div>
          <div class="tile"></div>
          <div class="tile"></div>
          <div class="tile"></div>
          <div class="tile"></div>
        </div>
      </div>
      <span class="board-divider">/</span>
      <div class="facist-board-container">
        <div class="fascist-board">
          <div class="tile"></div>
          <div class="tile"></div>
          <div class="tile"></div>
          <div class="tile"></div>
          <div class="tile"></div>
          <div class="tile"></div>
        </div>
      </div>
    </div>

    <div class="election-tracker-container">
      <!-- Remember to room the room.electiontracker after testing -->
      <div>failed elections: {{ room.electiontracker }}</div>
      <div class="circle election-1">1</div>
      <div class="circle election-2">2</div>
      <div class="circle election-3">3</div>
    </div>
  </p>

  <hr class="mid-page-break">

<!-- Dead or Alive -->
  {{# if dead }}
    <p>
      <b style="color: #90201B;">you are dead.</b><br />
      <span>Dead men tell no tales. Shh...</span>
    </p>
  {{/ if }}

<!-- chancellor-candidate picking view -->
  {{# if president }}
    <p>
      <b style="color: #2187FF;">you are the president!</b><br />
    </p>
    {{# if picking }}
    <span style="color: #1B9078;">choose your chancellor:</span>
    {{/ if }}
  {{ else }}
    {{# if picking }}
      <p>waiting for the president...</p>
    {{/ if }}
  {{/ if }}

  {{# if chancellor }}
    <p>
      <b style="color: #1B9078;">you are the chancellor!</b><br />
    </p>
  {{/ if }}

  {{# if voting }}
    <p>
      voting...waiting for {{ votesleft }} {{ peopleOrperson votesleft }}<br />
      {{# unless dead }}
        {{# if haventvoted }}
          <button class="yesvote-button">yes</button>
          <button class="novote-button">no</button>
        {{/ if }}
      {{/ unless }}
    </p>
  {{/ if }}

  {{# if votefailed }}
    <p>
      the vote failed...<br />
      waiting on {{ votecount }} {{ peopleOrperson votecount }}
    </p>
    {{# unless dead }}
      {{# unless haventvoted }}
        <p><button class="fail-continue-button">continue</button></p>
      {{/ unless }}
    {{/ unless}}
  {{/ if }}

<!-- Policy picking view / what everyone sees -->
  {{# if votepassed }}
    {{# if equals room.policychoices.length 3 }}
      <p>the vote passed!</p>
    {{/ if }}
    <!-- president view -->
    {{# if president }}
      {{# if equals room.policychoices.length 3 }}
      <!-- Veto button appears after 5th fascist policy -->
        {{# if presidentvetobutton }}
          <button class="veto-button" data-veto="president">Veto</button>
        {{/ if }}
        {{# if room.askchancellor }}
          <p>waiting for chancellor's veto approval...</p>
        {{ else }}
      <!-- when president is policy picking -->
          {{# if vetopassed 2 }}
            <p>chancellor approved of the veto</p>
            <button class="president-veto-continue">continue</button>
          {{ else }}
            {{# if vetofailed 2 }}
              <p>Chancellor did not approve on Veto</p>
            {{/ if }}
            <p>choose a policy to discard</p>
            <p>
              {{# each policy in room.policychoices }}
              <button class="pick-{{ policy }}">{{ policy }}</button>
              {{/ each }}
            </p>
          {{/ if }}
        {{/ if }}
      <!-- when chancellor is picking policy aka policychoices.length = 2 -->
      {{ else }}
        {{# unless executiveaction }}
          {{# if room.askpresident }}
            <p>Chancellor wants to Veto</p>
            <p>Do you approve?</p>
            <button class="yes-veto" data-veto="president">yes</button>
            <button class="no-veto" data-veto="president">no</button>
          {{ else }}
            <p>waiting for the chancellor...</p>
          {{/ if }}
        {{/ unless }}
      {{/ if }}
  <!-- End president policy picking view -->
    {{ else }}
    <!-- chancellor view -->
      {{# if chancellor }}
      <!-- during veto power, president seeking approval -->
        {{# if equals room.policychoices.length 3 }}
          {{# if room.askchancellor }}
            <p>President wants to Veto</p>
            <p>Do you approve?</p>
            <button class="yes-veto" data-veto="chancellor">yes</button>
            <button class="no-veto" data-veto="chancellor">no</button>
          {{ else }}
            <p>waiting for the president to discard a policy...</p>
          {{/ if }}
        {{/ if }}
      <!-- normal policy discard view -->
        {{# if equals room.policychoices.length 2 }}
          {{# if chancellorvetobutton }}
            <button class="veto-button" data-veto="chancellor">Veto</button>
          {{/ if }}
          {{# if room.askpresident }}
            <p>waiting for president's veto approval...</p>
          {{ else }}
            {{# if vetopassed 1 }}
              <p>President approved. Policies will be discarded.</p>
              <button class="chancellor-veto-continue">continue</button>
            {{ else }}
              {{# if vetofailed 1 }}
                <p>President did not approve with Veto</p>
              {{/ if }}
              <p>choose a policy to discard</p>
              <p>
                {{# each policy in room.policychoices }}
                <button class="pick-{{ policy }}">{{ policy }}</button>
                {{/ each }}
              </p>
            {{/ if }}
          {{/ if }}
        {{/ if }}
    <!-- everyone else's view -->
      {{ else }}
        {{# if equals room.policychoices.length 3 }}
          {{# if room.askchancellor }}
            <p>president has veto'd, waiting for chancellor's approval...</p>
          {{ else }}
            <p>waiting for the president...</p>
          {{/ if }}
        {{ else }}
        <!-- if executive power is live and president is deciding on how to use power -->
          {{# unless executiveaction }}
            {{# if room.askpresident }}
              <p>chancellor has veto'd, waiting for president's approval...</p>
            {{ else }}
              <p>waiting for the chancellor...</p>
            {{/ if }}
          {{/ unless }}
        {{/ if }}
      {{/ if }}
    {{/ if }}
  {{/ if }}

  <!-- Executive Action View -->
  {{# if executiveaction }}
    {{# if president }}

    <!-- Execution -->
    {{# if room.assassination }}
      <p>Execution. Who do you want to execute?</p>
    {{/ if }}
    <!-- End of execution -->

    <!-- Call Special Election -->
      {{# if room.specialelection }}
        <p>Special Election. Choose the next President.</p>
      {{/ if }}
    <!-- End of Special Election -->

    <!-- Investigate Loyalty -->
      {{# if room.investigate }}
        <p>Who do you want to investigate</p>
        {{# each suspect in room.suspects}}
          <button class="suspect" data-suspectid="{{ suspect.playerId }}">
            {{ suspect.name }}
          </button>
        {{/ each }}
      {{/ if  }}
      {{# if room.reveal }}
          <ul class="playerlist">
            {{# each suspect in room.suspected }}
              <li>{{ suspect.name }}({{ partymembership suspect }})</li>
            {{/ each }}
          </ul>
        <p><button class="investigate-continue-button">continue</button></p>
      {{/ if }}
    <!-- End of Investigate Loyalty -->

    <!-- Policy Peek -->
      {{# if equals room.peek.length 3 }}
        <p>Here are the next three Policies</p>
        <p>
          {{# each policy in room.peek }}
            <button>{{ policy }}</button>
          {{/ each }}
        </p>
        <p><button class="peek-continue-button">continue</button></p>
      {{/ if }}
    <!-- End of policy peek -->

    {{ else }}
      <!-- everyone else's view while President is using Presidential Power -->
      {{# if room.assassination }}
        <p>
          <b>Execution.</b><br />
          <span>President choosing who to execute...</span>
        </p>
      {{/ if }}
      {{# if room.specialelection }}
        <p>
          <b>Call Special Election.</b><br />
          <span>President choosing the next President...</span>
        </p>
      {{/ if }}
      {{# if room.investigate }}
        <p>
          <b>Investigate Loyalty.</b><br />
          <span>President is investigating someone's party membership...</span>
        </p>
      {{/ if }}
      {{# if equals room.peek.length 3 }}
        <p>
          <b>Policy Peek.</b><br />
          <span>President is examining the top three policy cards...</span>
        </p>
      {{/ if }}
    {{/ if }}

    <!-- Death Announcement -->
    {{# if room.playerdied }}
      {{# if president }}
        <p>You've chosen to execute {{ gravestonename }}</p>
        <p><button class="execution-continue-button">continue</button></p>
      {{ else }}
        {{# if newlydeceased }}
        <p>You died. Sorry.</p>
        {{ else }}
        <p>
          {{ gravestonename }} has been executed.<br />
        </p>
        {{/ if }}
      {{/ if }}
    {{/ if }}
    <!-- End of death announcement -->

  {{/ if }}
  <!-- End of Executive action view -->

  <ul class="ring circle-container-{{ players.length }}">
      {{# each players }}
        <li data-playerid={{ playerId }}>
          <span class={{ playercircle playerId }}>{{ name }}</span>
        </li>
      {{/ each }}
  </ul>

  <!-- Color Key Dropdown -->
  <div class="color-key-container">
    <button class="button-color-key">Color Key</button><br />
    <div id="color-key" class="color-key-dropdown">
      <li><i class="fa fa-circle-o fa-lg key-p" aria-hidden="true"></i><span class="key-p">president</span></li>
      <li><i class="fa fa-circle-o fa-lg key-ep" aria-hidden="true"></i><span class="key-ep">eligible presidential candidates</span></li>
      <li><i class="fa fa-circle-o fa-lg key-c" aria-hidden="true"></i><span class="key-c">chancellor</span></li>
      <li><i class="fa fa-circle-o fa-lg key-ec" aria-hidden="true"></i><span class="key-ec">eligible chancellor candidates</span></li>
      <li><i class="fa fa-circle-o fa-lg key-et" aria-hidden="true"></i><span class="key-et">execution targets</span></li>
      <li><i class="fa fa-circle-o fa-lg key-d" aria-hidden="true"></i><span class="key-d">dead</span></li>
    </div>
  </div>

  <!-- Presidential Power dropdown menu -->
  <button class="powers-button">Presidential Powers</button>
  <div class="presidential-powers" id="dropdown-menu">
    {{# each powers }}
      <li class ="power-name" data-powerid={{ id }}>{{ name }}</li>
      <p style="width:85%" class="power-description show" id="power-description-{{ id }}">{{ description }}</p>
    {{/ each }}
  </div>
</template>

<!-- <hr>
<button class="end-button">end game</button>
<button class="leave-button">leave game</button> -->
